---
title: "gapminder"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gapminder)
gapminder <- as_data_frame(gapminder)
```

1: Which country had the highest life expectancy in **1952**?

```{r}
gapminder_1952 <- gapminder %>%
  filter(year == 1952)

gapminder_1952 %>%
  arrange(desc(lifeExp)) %>%
  slice(1) %>%
  pluck("country")
```

2: Make a plot of the life expectancy (`lifeExp`) vs. population (`pop`)

```{r}
ggplot(gapminder_1952) +
  geom_point(aes(pop, lifeExp))
```

3: Change the color of the country depending on the continent

```{r}
ggplot(gapminder_1952) +
  geom_point(aes(pop, lifeExp, color = continent))
```

4: Change the size of the country depending the GPD

```{r}
ggplot(gapminder_1952) +
  geom_point(aes(pop, lifeExp, color = continent, size = gdpPercap))
```

5: Check if every country has the same number of measurements.

```{r}
gap_sum <- gapminder %>%
  group_by(country) %>%
  summarise(n = n())

all(gap_sum$n == 12)
```

6: Show the population growth on earth over time.

```{r}
gapminder %>%
  group_by(year) %>%
  summarise(total_pop_mlj = sum(pop / 1000000)) %>%
  ggplot() +
  geom_bar(aes(year, total_pop_mlj), stat = "identity") 
```


7: Show the average life expectancy per continent in a graph.

```{r}
gapminder %>%
  group_by(continent) %>%
  summarise(avg_life_exp = mean(lifeExp)) %>%
  ggplot() +
  geom_bar(aes(continent, avg_life_exp), stat = "identity")
```

8: Show in a graph for every country the percentage of the world population that
is living there in **2007**

```{r}
gapminder %>%
  filter(year == 2007) %>%
  mutate(pop_mlj = pop / 1000000) %>%
  mutate(perc = pop_mlj / sum(pop_mlj)) %>%
  arrange(desc(perc)) %>%
  slice(1:10) %>%
  ggplot() +
  geom_bar(aes(reorder(country, perc), perc), stat = "identity") +
  coord_flip()
```


---
title: "Extra Functions Exersice Answers"
output: html_notebook
---

```{r, include=FALSE}
library(tidyverse)
library(nycflights13)
library(lubridate)
flights <- flights %>%
  sample_n(20000)
```

1. Change the values of the following 4 columns to correct time:

  - `dep_time`
  - `sched_dep_time`
  - `arr_time`
  - `sched_arr_time`

```{r}
convert_to_date <- function(time, year, month, day) {
  make_datetime(
    year, month, day, time %/% 100, time %% 100)
}

flights %>%
  mutate_at(
    vars(ends_with("time")),
    ~convert_to_date(., year, month, day)
  )
```

2. Calculate the percentage of missing values for all columns

```{r}
perc_missing <- function(x) {
  sum(is.na(x)) / length(x) * 100
}
flights %>%
  summarise_all(perc_missing)
```

3. Multiply all numeric columns by 10 and add 2.

```{r}
diamonds %>%
  mutate_if(is.numeric, ~ . * 10 + 2)
```

4. Create a data frame with 20 rows that contains: 
  
  - a `group` column containing the values `group_1` till `group_5`
  - columns `a`, `b` and `c` containing the values **0** or **1**
  
```{r}
df <- tibble(
  "group" = rep(1:5, 4),
  "a" = sample(0:1, 20, replace = TRUE),
  "b" = sample(0:1, 20, replace = TRUE),
  "c" = sample(0:1, 20, replace = TRUE)
)
```

5. Calculate for every group the percentages of 1's for every column.

```{r}
perc <- function(col) {
  sum(col) / length(col)
}

df %>%
  group_by(group) %>%
  summarise_all(perc)
```
